冗長化（Redundancy）
======
障害が発生しても予備の機材でシステムの機能を継続できるようにすること。  
1. 障害を想定する  
2. 障害に備えて予備の機材を準備する  
3. 障害が発生した際に予備の機材に切り替えられる運用体制を整備する  

####ルータが故障した場合の対応
**コールドスタンバイ**によってルータが故障したとしても線を繋ぎ替えるだけで簡単に復旧できる。  
冗長化されたシステムでは現用機と予備機の設定は常に同じにしていなければならない。  

####Webサーバが故障した場合の対応
**ホットスタンバイ**によって現用機の内容を更新する際に予備機にも同じ更新がかかるようにしておき、現用機に何か起こった場合にすぐ予備機に切り替えられるようにしておくことですぐに復旧できる。  

##Webサーバの冗長化構成
###DNSラウンドロビン
###ロードバランサ

##重要な用語
###フェイルオーバ
現用機に障害が発生した際に自動的に処理を予備機に引き継ぐこと。  
* サーバをフェイルオーバする際にはVIP（Virtual IP Address）とIPアドレスの引き継ぎを利用する  
  * 現用機に自分のIPアドレスとは別にVIPを割り当てておき、WebサービスはVIPで提供するようにする  
  * 現用機に障害が発生した場合は予備機がVIPを引き継ぐ  
* 正常にフェイルオーバするには[ヘルスチェック](./redundancy.md#%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90)が必要である  

###ヘルスチェック  
現用機で障害が発生していることを検出する仕組み。  
* __ICMP監視（レイヤ3）__  
  * ICMP監視はICMPのechoリクエストを投げてリプライが返ってくるかをチェックする  
  * 最も簡単で軽いヘルスチェックだが、Webサービスがダウンした場合は検知できない  
  * __ルータのヘルスチェック__に向いている（ルータに対してICMP監視を行うのではなく、Webサーバに対して行う）  
* __ポート監視（レイヤ4）__  
  * ポート監視はTCPで接続を試み、接続できるかどうかをチェックする  
  * Webサービスがダウンしたことは検知できるが、過負荷状態で応答できなくなっていたりエラーを返していることは検知できない  
* __サービス監視（レイヤ7）__
  * 実際にHTTPリクエストなどを発行し正常な応答が返ってくるかどうかをチェックする  
  * ほとんどの異常を検知することができるが、場合によってはサーバに負担をかけてしまう  
  * __Webサーバのヘルスチェック__に向いている  
###スケジューリングアルゴリズム
###IPVS
